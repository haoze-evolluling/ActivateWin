# ActivateWin打包说明

## 简介
本文档说明了如何将ActivateWin打包成可执行文件和安装包。

## 打包方法

### 方法1：使用build.py自动打包（推荐）

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行打包脚本**
   ```bash
   python build.py
   ```

3. **获取结果**
   - 打包完成后，exe文件位于：`dist/ActivateWin.exe`
   - 可选：会创建zip压缩包

### 方法2：手动使用PyInstaller

1. **安装PyInstaller**
   ```bash
   pip install pyinstaller
   ```

2. **手动打包命令**
   ```bash
pyinstaller --name=ActivateWin --onefile --windowed --icon=icon1.ico kms_activator.py
```

3. **获取结果**
   - exe文件位于：`dist/ActivateWin.exe`

### 方法3：创建Python安装包

1. **创建wheel包**
   ```bash
   python setup.py bdist_wheel
   ```

2. **创建源码包**
   ```bash
   python setup.py sdist
   ```

3. **获取结果**
   - wheel包：`dist/activatewin-1.0.0-py3-none-any.whl`
   - 源码包：`dist/activatewin-1.0.0.tar.gz`

## 文件说明

### 打包相关文件
- `build.py` - 自动打包脚本
- `setup.py` - Python安装包配置
- `version_info.txt` - exe版本信息（自动创建）
- `requirements.txt` - 依赖列表

### 生成的文件
- `dist/` - 打包结果目录
- `build/` - 构建临时目录
- `*.spec` - PyInstaller配置文件

## 系统要求

### 开发环境
- Python 3.6或更高版本
- Windows操作系统
- pip包管理器

### 运行环境
- Windows 7/8/10/11
- Windows Server 2008/2012/2016/2019/2022
- 需要管理员权限运行

## 常见问题

### 1. 打包失败
- 确保安装了所有依赖：`pip install -r requirements.txt`
- 检查Python版本是否为3.6+
- 以管理员身份运行命令行

### 2. 杀毒软件误报
- 这是正常现象，KMS工具经常被误报
- 将exe文件添加到杀毒软件白名单
- 从可信来源下载

### 3. 运行时权限问题
- 必须以管理员身份运行程序
- 右键exe文件，选择"以管理员身份运行"

## 自定义打包

### 修改程序信息
编辑`build.py`中的以下变量：
- 版本号：`version = "1.0.0"`
- 程序名称：`--name=ActivateWin`
- 图标文件：`--icon=icon1.ico`

### 添加额外文件
修改`build.py`中的`--add-data`参数：
```python
"--add-data=filename;destination_folder",
```

## 发布建议

1. **创建发布包**
   - 包含exe文件
   - 包含README.md
   - 包含方法指导.md
   - 创建zip压缩包便于分发

2. **版本管理**
   - 每次更新修改setup.py中的版本号
   - 在README.md中记录更新日志

3. **测试建议**
   - 在不同Windows版本上测试
   - 测试管理员权限获取
   - 测试激活功能是否正常